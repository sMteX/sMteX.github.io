(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(t,e,i){t.exports=i(40)},40:function(t,e,i){"use strict";i.r(e);var a=i(0),n=i.n(a),s=i(23),r=i.n(s),h=i(4),o=i(5),u=i(10),l=i(7),c=i(11),d=i(45),p=i(42),v=i(15),y=i(24),m=i(2),f=i(41),g=i(44),C=i(12),b=function(t){function e(t){var i;return Object(h.a)(this,e),(i=Object(u.a)(this,Object(l.a)(e).call(this,t))).i=0,i.handleCanvasClick=i.handleCanvasClick.bind(Object(m.a)(i)),i.handleCityClick=i.handleCityClick.bind(Object(m.a)(i)),i}return Object(c.a)(e,t),Object(o.a)(e,[{key:"handleCanvasClick",value:function(t){0===t.evt.button&&(this.props.addCity({index:this.i,x:t.evt.offsetX,y:t.evt.offsetY}),this.i++)}},{key:"handleCityClick",value:function(t){var e=this;return function(i){0===e.props.paths.length&&2===i.evt.button&&e.props.removeCity(t)}}},{key:"render",value:function(){var t=this,e=this.pathsWithCoords;return n.a.createElement(C.Stage,{width:500,height:500,onClick:this.handleCanvasClick,onContextMenu:function(t){return t.evt.preventDefault()}},n.a.createElement(C.Layer,null,n.a.createElement(C.Rect,{x:0,y:0,width:500,height:500,stroke:"black"}),e.map(function(t){var e=t.order,i=t.points;return n.a.createElement(C.Line,{key:e,points:i,stroke:"green",strokeWidth:2})}),this.props.cities.map(function(e){var i=e.index,a=e.x,s=e.y,r=i>=10?-7:-3;return n.a.createElement(n.a.Fragment,{key:i},n.a.createElement(C.Circle,{x:a,y:s,radius:8,fill:"red",onClick:t.handleCityClick(i)}),n.a.createElement(C.Text,{text:i.toString(),x:a+r,y:s+-18}))})))}},{key:"pathsWithCoords",get:function(){var t=this,e=this.props.paths.map(function(e){return{order:e.order,startX:t.props.cities[e.startCityIndex].x,startY:t.props.cities[e.startCityIndex].y,endX:t.props.cities[e.endCityIndex].x,endY:t.props.cities[e.endCityIndex].y}}),i=this.props.paths.map(function(e){var i=t.props.cities[e.startCityIndex].x,a=t.props.cities[e.startCityIndex].y,n=t.props.cities[e.endCityIndex].x,s=t.props.cities[e.endCityIndex].y,r=Math.sqrt(Math.pow(n-i,2)+Math.pow(s-a,2));return{startCityIndex:e.startCityIndex,endCityIndex:e.endCityIndex,length:r}});return i.forEach(function(t){t.length}),e.map(function(t){var e=Math.sqrt(Math.pow(t.endX-t.startX,2)+Math.pow(t.endY-t.startY,2)),i={x:t.startX+(t.endX-t.startX)/2,y:t.startY+(t.endY-t.startY)/2};return{order:t.order,points:[t.startX,t.startY,t.endX,t.endY],length:e,lengthCoords:i}})}}]),e}(n.a.Component),x=i(13),E=function(t){function e(t){var i;return Object(h.a)(this,e),(i=Object(u.a)(this,Object(l.a)(e).call(this,t))).handleSettingsChange=i.handleSettingsChange.bind(Object(m.a)(i)),i}return Object(c.a)(e,t),Object(o.a)(e,[{key:"handleSettingsChange",value:function(t){var e=this;return function(i){if("advanced"===t){var a=!e.props.settings.advanced;e.props.setSettings({advanced:a})}else e.props.setSettings(Object(x.a)({},t,Number(i.currentTarget.value)))}}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"dt:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:.01,onChange:this.handleSettingsChange("dt"),value:this.props.settings.dt}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"alpha:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:1,onChange:this.handleSettingsChange("alpha"),value:this.props.settings.alpha}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"tau:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:.1,onChange:this.handleSettingsChange("tau"),value:this.props.settings.tau}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"A:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:.05,onChange:this.handleSettingsChange("A"),value:this.props.settings.A}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"B:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:.05,onChange:this.handleSettingsChange("B"),value:this.props.settings.B}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"C:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:.05,onChange:this.handleSettingsChange("C"),value:this.props.settings.C}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"D:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:.05,onChange:this.handleSettingsChange("D"),value:this.props.settings.D}))),n.a.createElement(f.a,null,n.a.createElement(p.a,{md:4,style:{textAlign:"right"}},n.a.createElement("label",null,"max. iterac\xed:")),n.a.createElement(p.a,{md:8},n.a.createElement("input",{type:"number",step:10,onChange:this.handleSettingsChange("maxIterations"),value:this.props.settings.maxIterations}))))}}]),e}(n.a.Component),k=Math.sqrt(5e5),O=function(){function t(e,i){Object(h.a)(this,t),this.n=void 0,this.weights=void 0,this.activations=void 0,this.outputs=void 0,this.cityOutputs=void 0,this.timeOutputs=void 0,this.totalOutput=void 0,this.distances=void 0,this.tourByCity=void 0,this.tourByTime=void 0,this.maxIterations=void 0,this.dt=void 0,this.alpha=void 0,this.tau=void 0,this.A=void 0,this.B=void 0,this.C=void 0,this.D=void 0,this.isTourFound=!1;var a=i.dt,n=i.alpha,s=i.A,r=i.B,o=i.C,u=i.D,l=i.maxIterations,c=i.tau;this.dt=a,this.alpha=n,this.tau=c,this.A=s,this.B=r,this.C=o,this.D=u,this.maxIterations=l,this.n=e.length,this.weights=t.initializeSquareMatrix(this.n*this.n),this.activations=t.initializeSquareMatrix(this.n),this.outputs=t.initializeSquareMatrix(this.n),this.cityOutputs=t.initializeArray(this.n),this.timeOutputs=t.initializeArray(this.n),this.totalOutput=0,this.distances=t.initializeSquareMatrix(this.n),this.tourByCity=t.initializeArray(this.n),this.tourByTime=t.initializeArray(this.n),this.populateDistances(e),this.setupNeurons()}return Object(o.a)(t,[{key:"calculateActivations",value:function(){for(var t=this.totalOutput-this.n,e=0;e<this.n;e++)for(var i=0;i<this.n;i++){for(var a=0,n=i===this.n-1?0:i+1,s=0===i?this.n-1:i-1,r=this.cityOutputs[e]-this.outputs[e][i],h=this.timeOutputs[i]-this.outputs[e][i],o=0;o<this.n;o++)a+=this.distances[e][o]*(this.outputs[o][n]+this.outputs[o][s])/k;var u=this.dt*(-this.activations[e][i]/this.tau-this.A*r-this.B*h-this.C*t-this.D*a);this.activations[e][i]+=u}}},{key:"train",value:function(){var t,e;t=this.energy;var i=0;do{if(this.calculateActivations(),this.calculateOutputs(),t-(e=this.energy)<1e-7)break;t=e,i++}while(i<this.maxIterations);this.findTour()}},{key:"train2",value:function(){var t,e;t=this.energy;for(var i=0,a=Number.MAX_VALUE,n=[],s=0,r=0,h=0;h<1e3;h++){i=0,this.setupNeurons(),r=0;do{if(this.calculateActivations(),this.calculateOutputs(),t-(e=this.energy)<1e-6?r++:r=0,50===r)break;t=e,i++}while(i<this.maxIterations);this.findTour();var o=this.totalDistance;o<a&&(a=o,n=Object(v.a)(this.tourByTime),s=h)}return{paths:n,distance:a,k:s}}},{key:"findTour",value:function(){for(var e=t.initializeSquareMatrix(this.n),i={value:-10,x:null,i:-1},a=0;a<this.n;a++)for(var n=0;n<this.n;n++)e[a][n]=0;for(var s=0;s<this.n;s++){i.value=-10;for(var r=0;r<this.n;r++){for(var h=0;h<this.n;h++)this.outputs[s][h]>=i.value&&0===e[s][h]&&(i.value=this.outputs[s][h],i.x=s,i.i=h);if(s===i.x&&r===i.i&&0===e[s][r]){this.tourByCity[s]=r,this.tourByTime[r]=s;for(var o=0;o<this.n;o++)e[s][o]=1,e[o][r]=1}}}this.isTourFound=!0}},{key:"setupNeurons",value:function(){this.calculateWeightMatrix(),this.assignInputs(),this.calculateOutputs()}},{key:"calculateWeightMatrix",value:function(){for(var e=0;e<this.n;e++)for(var i=0;i<this.n;i++)for(var a=i+e*this.n,n=0;n<this.n;n++)for(var s=0;s<this.n;s++){var r=s+n*this.n,h=s===this.n-1?0:s+1,o=0===s?this.n-1:s-1,u=t.kroneckerDelta(e,n),l=t.kroneckerDelta(i,s),c=t.kroneckerDelta(i,h),d=t.kroneckerDelta(i,o);this.weights[a][r]=-this.A*u*(1-l)-this.B*l*(1-u)-this.C-this.D*this.distances[e][n]*(c+d)/k}}},{key:"assignInputs",value:function(){for(var e=t.initializeSquareMatrix(this.n),i=0;i<this.n;i++){e[i]=[];for(var a=0;a<this.n;a++)e[i][a]=Math.random()}for(var n=0;n<this.n;n++)for(var s=0;s<this.n;s++)this.activations[n][s]=0;for(var r=0;r<this.n;r++)for(var h=0;h<this.n;h++)for(var o=h+r*this.n,u=0;u<this.n;u++)for(var l=0;l<this.n;l++){var c=l+u*this.n;this.activations[r][h]+=this.weights[o][c]*e[r][h]}}},{key:"calculateOutputs",value:function(){this.totalOutput=0;for(var t=0;t<this.n;t++){this.cityOutputs[t]=0;for(var e=0;e<this.n;e++)this.outputs[t][e]=(1+Math.tanh(this.alpha*this.activations[t][e]))/2,this.cityOutputs[t]+=this.outputs[t][e];this.totalOutput+=this.cityOutputs[t]}for(var i=0;i<this.n;i++){this.timeOutputs[i]=0;for(var a=0;a<this.n;a++)this.timeOutputs[i]+=this.outputs[a][i]}}},{key:"populateDistances",value:function(e){for(var i=0;i<this.n;i++)for(var a=0;a<this.n;a++)this.distances[i][a]=t.calculateDistance(e[i],e[a])}},{key:"energy",get:function(){for(var t=0,e=0,i=0,a=0,n=0;n<this.n;n++)for(var s=n===this.n-1?0:n+1,r=0===n?this.n-1:n-1,h=0;h<this.n;h++){i+=this.outputs[n][h];for(var o=0;o<this.n;o++)o!==h&&(t+=this.outputs[n][h]*this.outputs[n][o],e+=this.outputs[h][n]*this.outputs[o][n],a+=this.distances[o][h]*this.outputs[o][n]*(this.outputs[h][s]+this.outputs[h][r])/k)}return.5*(this.A*t+this.B*e+this.C*Math.pow(i-this.n,2)+this.D*a)}},{key:"totalDistance",get:function(){if(!this.isTourFound)throw new Error("Tour wasn't found yet");for(var t=0,e=0;e<this.n;e++){var i=this.tourByTime[e],a=e===this.n-1?this.tourByTime[0]:this.tourByTime[e+1];t+=this.distances[i][a]}return t}}],[{key:"kroneckerDelta",value:function(t,e){return t===e?1:0}},{key:"calculateDistance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"initializeArray",value:function(t){return Array.from({length:t})}},{key:"initializeSquareMatrix",value:function(e){return t.initializeArray(e).map(function(i){return t.initializeArray(e)})}},{key:"stringifyNeurons",value:function(t){var e=t.map(function(t){return"[".concat(t.map(function(t){return t.toFixed(4)}).join(", "),"]")});return"[".concat(e.join("\n"),"]")}}]),t}(),j=i(43),S=function(t){function e(t){var i;return Object(h.a)(this,e),(i=Object(u.a)(this,Object(l.a)(e).call(this,t))).optionChanged=i.optionChanged.bind(Object(m.a)(i)),i}return Object(c.a)(e,t),Object(o.a)(e,[{key:"optionChanged",value:function(t){var e=Number(t.currentTarget.value);this.props.overrideState(this.props.history.find(function(t){return t.index===e}))}},{key:"render",value:function(){return n.a.createElement(j.a,{type:"select",size:10,onChange:this.optionChanged},this.props.history.map(function(t){return n.a.createElement("option",{value:t.index},"Po\u010det m\u011bst: ",t.cities.length,", d\xe9lka: ",t.distance.toFixed(3))}))}}]),e}(n.a.Component),A=function t(e,i){Object(h.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=i},D={dt:.05,alpha:3,A:.5,B:.5,C:.2,D:1.25,maxIterations:1500,tau:1,advanced:!0},I=[{index:0,x:100,y:300},{index:1,x:200,y:150},{index:2,x:75,y:200},{index:3,x:350,y:50}],w=function(t){function e(t){var i;return Object(h.a)(this,e),(i=Object(u.a)(this,Object(l.a)(e).call(this,t))).historyI=0,i.state={settings:D,cities:[],paths:[],history:[]},i.setSettings=i.setSettings.bind(Object(m.a)(i)),i.addCity=i.addCity.bind(Object(m.a)(i)),i.removeCity=i.removeCity.bind(Object(m.a)(i)),i.findPaths=i.findPaths.bind(Object(m.a)(i)),i.setDefaultCities=i.setDefaultCities.bind(Object(m.a)(i)),i.reset=i.reset.bind(Object(m.a)(i)),i.overrideState=i.overrideState.bind(Object(m.a)(i)),i.clearHistory=i.clearHistory.bind(Object(m.a)(i)),i}return Object(c.a)(e,t),Object(o.a)(e,[{key:"setSettings",value:function(t){var e=Object(y.a)({},this.state.settings,t);this.setState({settings:e})}},{key:"addCity",value:function(t){this.setState(function(e){return{cities:[].concat(Object(v.a)(e.cities),[t])}})}},{key:"removeCity",value:function(t){this.setState(function(e){return{cities:e.cities.filter(function(e){return e.index!==t})}})}},{key:"findPaths",value:function(){var t,i,a=this.state.cities.map(function(t){var e=t.x,i=t.y;return new A(e,i)}),n=new O(a,this.state.settings);if(this.state.settings.advanced){console.log("Please wait...");var s=n.train2(),r=s.paths,h=s.distance,o=s.k;console.log("Finished, found min in iteration ".concat(o)),t=e.transformPaths(r),i=h}else n.train(),i=n.totalDistance,t=e.transformPaths(n.tourByTime);var u={index:this.historyI,cities:this.state.cities,paths:t,settings:this.state.settings,distance:i};this.historyI++,this.state.history.push(JSON.parse(JSON.stringify(u))),this.setState({totalDistance:i,paths:t})}},{key:"setDefaultCities",value:function(){this.setState({cities:I})}},{key:"reset",value:function(){this.setState({totalDistance:void 0,cities:[],paths:[]})}},{key:"overrideState",value:function(t){this.setState({paths:t.paths,totalDistance:t.distance,cities:t.cities,settings:t.settings})}},{key:"clearHistory",value:function(){this.historyI=0,this.setState({history:[]})}},{key:"render",value:function(){return n.a.createElement(f.a,{style:{marginTop:20}},n.a.createElement(p.a,{md:5},n.a.createElement("h4",null,"Nastaven\xed parametr\u016f"),n.a.createElement(E,{setSettings:this.setSettings,settings:this.state.settings})," ",n.a.createElement("br",null),n.a.createElement(g.a,{onClick:this.findPaths},"Naj\xedt cestu"),n.a.createElement(g.a,{onClick:this.reset,style:{marginLeft:15}},"Reset"),n.a.createElement(g.a,{onClick:this.clearHistory,style:{marginLeft:15}},"Vy\u010distit historii"),n.a.createElement("br",null),this.state.totalDistance&&n.a.createElement("span",{style:{marginTop:10}},"Celkov\xe1 d\xe9lka cesty: ",this.state.totalDistance.toFixed(3)),n.a.createElement("br",null),this.state.history.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h4",null,"Historie"),n.a.createElement(S,{overrideState:this.overrideState,history:this.state.history.sort(function(t,e){return e.index-t.index})}))),n.a.createElement(p.a,{md:7},n.a.createElement(b,{addCity:this.addCity,removeCity:this.removeCity,cities:this.state.cities,paths:this.state.paths})))}}],[{key:"transformPaths",value:function(t){for(var e=[],i=0;i<t.length;i++){var a=i===t.length-1?0:i+1;e.push({order:i,startCityIndex:t[i],endCityIndex:t[a]})}return e}}]),e}(n.a.Component),M=function(t){function e(){return Object(h.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(c.a)(e,t),Object(o.a)(e,[{key:"render",value:function(){return n.a.createElement(d.a,{fluid:!0},n.a.createElement(p.a,{md:{size:9,offset:2}},n.a.createElement("h1",null,"Probl\xe9m obchodn\xedho cestuj\xedc\xedho"),n.a.createElement(w,null)))}}]),e}(a.Component);i(39);r.a.render(n.a.createElement(M,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.dac5f487.chunk.js.map